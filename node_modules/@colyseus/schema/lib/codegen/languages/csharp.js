"use strict";
var __read = (this && this.__read) || function (o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
};
var __spread = (this && this.__spread) || function () {
    for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
    return ar;
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.generate = void 0;
var types_1 = require("../types");
var typeMaps = {
    "string": "string",
    "number": "float",
    "boolean": "bool",
    "int8": "int",
    "uint8": "uint",
    "int16": "short",
    "uint16": "ushort",
    "int32": "int",
    "uint32": "uint",
    "int64": "long",
    "uint64": "ulong",
    "float32": "float",
    "float64": "double",
};
/**
 * C# Code Generator
 */
var capitalize = function (s) {
    if (typeof s !== 'string')
        return '';
    return s.charAt(0).toUpperCase() + s.slice(1);
};
function generate(context, options) {
    return __spread(context.classes.map(function (structure) { return ({
        name: structure.name + ".cs",
        content: generateClass(structure, options.namespace)
    }); }), context.interfaces.map(function (structure) { return ({
        name: structure.name + ".cs",
        content: generateInterface(structure, options.namespace)
    }); }));
}
exports.generate = generate;
function generateClass(klass, namespace) {
    var indent = (namespace) ? "\t" : "";
    return types_1.getCommentHeader() + "\n\nusing Colyseus.Schema;\n" + (namespace ? "\nnamespace " + namespace + " {" : "") + "\n" + indent + "public partial class " + klass.name + " : " + klass.extends + " {\n" + klass.properties.map(function (prop) { return generateProperty(prop, indent); }).join("\n\n") + "\n" + indent + "}\n" + (namespace ? "}" : "") + "\n";
}
function generateProperty(prop, indent) {
    if (indent === void 0) { indent = ""; }
    var typeArgs = "\"" + prop.type + "\"";
    var property = "public";
    var langType;
    var initializer = "";
    if (prop.childType) {
        var isUpcaseFirst = prop.childType.match(/^[A-Z]/);
        if (prop.type === "ref") {
            langType = (isUpcaseFirst)
                ? prop.childType
                : getChildType(prop);
        }
        else {
            var containerClass = capitalize(prop.type);
            langType = (isUpcaseFirst)
                ? containerClass + "Schema<" + prop.childType + ">"
                : containerClass + "Schema<" + getChildType(prop) + ">";
        }
        typeArgs += ", typeof(" + langType + ")";
        if (!isUpcaseFirst) {
            typeArgs += ", \"" + prop.childType + "\"";
        }
        initializer = "new " + langType + "()";
    }
    else {
        langType = getType(prop);
        initializer = "default(" + langType + ")";
    }
    property += " " + langType + " " + prop.name;
    var ret = (prop.deprecated) ? "\t\t[System.Obsolete(\"field '" + prop.name + "' is deprecated.\", true)]\n" : '';
    return ret + ("\t" + indent + "[Type(" + prop.index + ", " + typeArgs + ")]\n\t" + indent + property + " = " + initializer + ";");
}
function generateInterface(struct, namespace) {
    var indent = (namespace) ? "\t" : "";
    return types_1.getCommentHeader() + "\n\nusing Colyseus.Schema;\n" + (namespace ? "\nnamespace " + namespace + " {" : "") + "\n" + indent + "public class " + struct.name + " {\n" + struct.properties.map(function (prop) { return "\t" + indent + "public " + getType(prop) + " " + prop.name + ";"; }).join("\n") + "\n" + indent + "}\n" + (namespace ? "}" : "") + "\n";
}
function getChildType(prop) {
    return typeMaps[prop.childType];
}
function getType(prop) {
    return (prop.type === "array")
        ? (typeMaps[prop.childType] || prop.childType) + "[]"
        : typeMaps[prop.type];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3NoYXJwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvZGVnZW4vbGFuZ3VhZ2VzL2NzaGFycC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGtDQUE4RTtBQUk5RSxJQUFNLFFBQVEsR0FBRztJQUNiLFFBQVEsRUFBRSxRQUFRO0lBQ2xCLFFBQVEsRUFBRSxPQUFPO0lBQ2pCLFNBQVMsRUFBRSxNQUFNO0lBQ2pCLE1BQU0sRUFBRSxLQUFLO0lBQ2IsT0FBTyxFQUFFLE1BQU07SUFDZixPQUFPLEVBQUUsT0FBTztJQUNoQixRQUFRLEVBQUUsUUFBUTtJQUNsQixPQUFPLEVBQUUsS0FBSztJQUNkLFFBQVEsRUFBRSxNQUFNO0lBQ2hCLE9BQU8sRUFBRSxNQUFNO0lBQ2YsUUFBUSxFQUFFLE9BQU87SUFDakIsU0FBUyxFQUFFLE9BQU87SUFDbEIsU0FBUyxFQUFFLFFBQVE7Q0FDdEIsQ0FBQTtBQUVEOztHQUVHO0FBQ0gsSUFBTSxVQUFVLEdBQUcsVUFBQyxDQUFDO0lBQ2pCLElBQUksT0FBTyxDQUFDLEtBQUssUUFBUTtRQUFFLE9BQU8sRUFBRSxDQUFBO0lBQ3BDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2xELENBQUMsQ0FBQTtBQUVELFNBQWdCLFFBQVEsQ0FBRSxPQUFnQixFQUFFLE9BQXdCO0lBQ2hFLGdCQUNPLE9BQU8sQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQUEsU0FBUyxJQUFJLE9BQUEsQ0FBQztRQUNqQyxJQUFJLEVBQUssU0FBUyxDQUFDLElBQUksUUFBSztRQUM1QixPQUFPLEVBQUUsYUFBYSxDQUFDLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUyxDQUFDO0tBQ3ZELENBQUMsRUFIa0MsQ0FHbEMsQ0FBQyxFQUNBLE9BQU8s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V0FBTSxXQUFXLE1BQUcsQ0FBQSxDQUFDO0FBQzFDLENBQUM7QUFFRCxTQUFTLGlCQUFpQixDQUFDLE1BQWlCLEVBQUUsU0FBaUI7SUFDM0QsSUFBTSxNQUFNLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDdkMsT0FBVSx3QkFBZ0IsRUFBRSxxQ0FHOUIsU0FBUyxDQUFDLENBQUMsQ0FBQyxpQkFBZSxTQUFTLE9BQUksQ0FBQyxDQUFDLENBQUMsRUFBRSxXQUM3QyxNQUFNLHFCQUFnQixNQUFNLENBQUMsSUFBSSxZQUNqQyxNQUFNLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFBLElBQUksSUFBSSxPQUFBLE9BQUssTUFBTSxlQUFVLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBSSxJQUFJLENBQUMsSUFBSSxNQUFHLEVBQWxELENBQWtELENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQzVGLE1BQU0sWUFDTixTQUFTLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxRQUNyQixDQUFDO0FBQ0YsQ0FBQztBQUVELFNBQVMsWUFBWSxDQUFDLElBQWM7SUFDaEMsT0FBTyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ3BDLENBQUM7QUFFRCxTQUFTLE9BQU8sQ0FBQyxJQUFjO0lBQzNCLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLElBQUksQ0FBQyxTQUFTLFFBQUk7UUFDbkQsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDOUIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENsYXNzLCBQcm9wZXJ0eSwgRmlsZSwgZ2V0Q29tbWVudEhlYWRlciwgSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBHZW5lcmF0ZU9wdGlvbnMgfSBmcm9tIFwiLi4vYXBpXCI7XG5pbXBvcnQgeyBDb250ZXh0IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmNvbnN0IHR5cGVNYXBzID0ge1xuICAgIFwic3RyaW5nXCI6IFwic3RyaW5nXCIsXG4gICAgXCJudW1iZXJcIjogXCJmbG9hdFwiLFxuICAgIFwiYm9vbGVhblwiOiBcImJvb2xcIixcbiAgICBcImludDhcIjogXCJpbnRcIixcbiAgICBcInVpbnQ4XCI6IFwidWludFwiLFxuICAgIFwiaW50MTZcIjogXCJzaG9ydFwiLFxuICAgIFwidWludDE2XCI6IFwidXNob3J0XCIsXG4gICAgXCJpbnQzMlwiOiBcImludFwiLFxuICAgIFwidWludDMyXCI6IFwidWludFwiLFxuICAgIFwiaW50NjRcIjogXCJsb25nXCIsXG4gICAgXCJ1aW50NjRcIjogXCJ1bG9uZ1wiLFxuICAgIFwiZmxvYXQzMlwiOiBcImZsb2F0XCIsXG4gICAgXCJmbG9hdDY0XCI6IFwiZG91YmxlXCIsXG59XG5cbi8qKlxuICogQyMgQ29kZSBHZW5lcmF0b3JcbiAqL1xuY29uc3QgY2FwaXRhbGl6ZSA9IChzKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBzICE9PSAnc3RyaW5nJykgcmV0dXJuICcnXG4gICAgcmV0dXJuIHMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzLnNsaWNlKDEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGUgKGNvbnRleHQ6IENvbnRleHQsIG9wdGlvbnM6IEdlbmVyYXRlT3B0aW9ucyk6IEZpbGVbXSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgLi4uY29udGV4dC5jbGFzc2VzLm1hcChzdHJ1Y3R1cmUgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IGAke3N0cnVjdHVyZS5uYW1lfS5jc2AsXG4gICAgICAgICAgICBjb250ZW50OiBnZW5lcmF0ZUNsYXNzKHN0cnVjdHVyZSwgb3B0aW9ucy5uYW1lc3BhY2UpXG4gICAgICAgIH0pKSxcbiAgICAgICAgLi4uY29udGV4dC5pbnRlcmZhY2VzLm1hcChzdHJ1Y3R1cmUgPT4gKHtcbiAgICAgICAgICAgIG5hbWU6IGAke3N0cnVjdHVyZS5uYW1lfS5jc2AsXG4gICAgICAgICAgICBjb250ZW50OiBnZW5lcmF0ZUludGVyZmFjZShzdHJ1Y3R1cmUsIG9wdGlvbnMubmFtZXNwYWNlKVxuICAgICAgICB9KSlcbiAgICBdO1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZUNsYXNzKGtsYXNzOiBDbGFzcywgbmFtZXNwYWNlOiBzdHJpbmcpIHtcbiAgICBjb25zdCBpbmRlbnQgPSAobmFtZXNwYWNlKSA/IFwiXFx0XCIgOiBcIlwiO1xuICAgIHJldHVybiBgJHtnZXRDb21tZW50SGVhZGVyKCl9XG5cbnVzaW5nIENvbHlzZXVzLlNjaGVtYTtcbiR7bmFtZXNwYWNlID8gYFxcbm5hbWVzcGFjZSAke25hbWVzcGFjZX0ge2AgOiBcIlwifVxuJHtpbmRlbnR9cHVibGljIHBhcnRpYWwgY2xhc3MgJHtrbGFzcy5uYW1lfSA6ICR7a2xhc3MuZXh0ZW5kc30ge1xuJHtrbGFzcy5wcm9wZXJ0aWVzLm1hcChwcm9wID0+IGdlbmVyYXRlUHJvcGVydHkocHJvcCwgaW5kZW50KSkuam9pbihcIlxcblxcblwiKX1cbiR7aW5kZW50fX1cbiR7bmFtZXNwYWNlID8gXCJ9XCIgOiBcIlwifVxuYDtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVQcm9wZXJ0eShwcm9wOiBQcm9wZXJ0eSwgaW5kZW50OiBzdHJpbmcgPSBcIlwiKSB7XG4gICAgbGV0IHR5cGVBcmdzID0gYFwiJHtwcm9wLnR5cGV9XCJgO1xuICAgIGxldCBwcm9wZXJ0eSA9IFwicHVibGljXCI7XG4gICAgbGV0IGxhbmdUeXBlOiBzdHJpbmc7XG4gICAgbGV0IGluaXRpYWxpemVyID0gXCJcIjtcblxuICAgIGlmIChwcm9wLmNoaWxkVHlwZSkge1xuICAgICAgICBjb25zdCBpc1VwY2FzZUZpcnN0ID0gcHJvcC5jaGlsZFR5cGUubWF0Y2goL15bQS1aXS8pO1xuXG4gICAgICAgIGlmKHByb3AudHlwZSA9PT0gXCJyZWZcIikge1xuICAgICAgICAgICAgbGFuZ1R5cGUgPSAoaXNVcGNhc2VGaXJzdClcbiAgICAgICAgICAgICAgICA/IHByb3AuY2hpbGRUeXBlXG4gICAgICAgICAgICAgICAgOiBnZXRDaGlsZFR5cGUocHJvcCk7XG5cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lckNsYXNzID0gY2FwaXRhbGl6ZShwcm9wLnR5cGUpO1xuXG4gICAgICAgICAgICBsYW5nVHlwZSA9IChpc1VwY2FzZUZpcnN0KVxuICAgICAgICAgICAgICAgID8gYCR7Y29udGFpbmVyQ2xhc3N9U2NoZW1hPCR7cHJvcC5jaGlsZFR5cGV9PmBcbiAgICAgICAgICAgICAgICA6IGAke2NvbnRhaW5lckNsYXNzfVNjaGVtYTwke2dldENoaWxkVHlwZShwcm9wKX0+YDtcbiAgICAgICAgfVxuXG4gICAgICAgIHR5cGVBcmdzICs9IGAsIHR5cGVvZigke2xhbmdUeXBlfSlgO1xuXG4gICAgICAgIGlmICghaXNVcGNhc2VGaXJzdCkge1xuICAgICAgICAgICAgdHlwZUFyZ3MgKz0gYCwgXCIke3Byb3AuY2hpbGRUeXBlfVwiYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGluaXRpYWxpemVyID0gYG5ldyAke2xhbmdUeXBlfSgpYDtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIGxhbmdUeXBlID0gZ2V0VHlwZShwcm9wKTtcbiAgICAgICAgaW5pdGlhbGl6ZXIgPSBgZGVmYXVsdCgke2xhbmdUeXBlfSlgO1xuICAgIH1cblxuICAgIHByb3BlcnR5ICs9IGAgJHtsYW5nVHlwZX0gJHtwcm9wLm5hbWV9YDtcblxuICAgIGxldCByZXQgPSAocHJvcC5kZXByZWNhdGVkKSA/IGBcXHRcXHRbU3lzdGVtLk9ic29sZXRlKFwiZmllbGQgJyR7cHJvcC5uYW1lfScgaXMgZGVwcmVjYXRlZC5cIiwgdHJ1ZSldXFxuYCA6ICcnO1xuXG4gICAgcmV0dXJuIHJldCArIGBcXHQke2luZGVudH1bVHlwZSgke3Byb3AuaW5kZXh9LCAke3R5cGVBcmdzfSldXG5cXHQke2luZGVudH0ke3Byb3BlcnR5fSA9ICR7aW5pdGlhbGl6ZXJ9O2A7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlSW50ZXJmYWNlKHN0cnVjdDogSW50ZXJmYWNlLCBuYW1lc3BhY2U6IHN0cmluZykge1xuICAgIGNvbnN0IGluZGVudCA9IChuYW1lc3BhY2UpID8gXCJcXHRcIiA6IFwiXCI7XG4gICAgcmV0dXJuIGAke2dldENvbW1lbnRIZWFkZXIoKX1cblxudXNpbmcgQ29seXNldXMuU2NoZW1hO1xuJHtuYW1lc3BhY2UgPyBgXFxubmFtZXNwYWNlICR7bmFtZXNwYWNlfSB7YCA6IFwiXCJ9XG4ke2luZGVudH1wdWJsaWMgY2xhc3MgJHtzdHJ1Y3QubmFtZX0ge1xuJHtzdHJ1Y3QucHJvcGVydGllcy5tYXAocHJvcCA9PiBgXFx0JHtpbmRlbnR9cHVibGljICR7Z2V0VHlwZShwcm9wKX0gJHtwcm9wLm5hbWV9O2ApLmpvaW4oXCJcXG5cIil9XG4ke2luZGVudH19XG4ke25hbWVzcGFjZSA/IFwifVwiIDogXCJcIn1cbmA7XG59XG5cbmZ1bmN0aW9uIGdldENoaWxkVHlwZShwcm9wOiBQcm9wZXJ0eSkge1xuICAgIHJldHVybiB0eXBlTWFwc1twcm9wLmNoaWxkVHlwZV07XG59XG5cbmZ1bmN0aW9uIGdldFR5cGUocHJvcDogUHJvcGVydHkpIHtcbiAgICByZXR1cm4gKHByb3AudHlwZSA9PT0gXCJhcnJheVwiKVxuICAgICAgICA/IGAke3R5cGVNYXBzW3Byb3AuY2hpbGRUeXBlXSB8fCBwcm9wLmNoaWxkVHlwZX1bXWBcbiAgICAgICAgOiB0eXBlTWFwc1twcm9wLnR5cGVdO1xufSJdfQ==